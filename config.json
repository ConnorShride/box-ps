{
    "environment": {
        "$env:allusersprofile": "C:\\ProgramData",
        "$env:appdata": "C:\\Users\\victim\\AppData\\Roaming",
        "$env:commonprogramfiles": "C:\\Program Files\\Common Files",
        "${env:commonprogramfiles}": "C:\\Program Files (x86)\\Common Files",
        "$env:commonprogramw6432": "C:\\Program Files\\Common Files",
        "$env:computername": "victimbox",
        "$env:comspec": "C:\\WINDOWS\\system32\\cmd.exe",
        "$env:homedrive": "C:",
        "$env:homepath": "\\Users\\victim",
        "$env:localappdata": "C:\\Users\\victim\\AppData\\Local",
        "$env:logonserver": "\\\\fakelogonserver",
        "$env:path": "C:\\Program Files\\Python35\\Scripts\\;C:\\Program Files\\Python35\\;C:\\Program Files (x86)\\Common Files\\Oracle\\Java\\javapath;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files\\Java\\jdk-10.0.2\\bin;",
        "$env:programdata": "C:\\ProgramData",
        "$env:programfiles": "C:\\Program Files",
        "${env:programfiles(x86)}": "C:\\Program Files (x86)",
        "$env:program6432": "C:\\Program Files",
        "$env:psmodulepath": "C:\\Users\\victim\\Documents\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules",
        "$env:public": "C:\\Users\\Public",
        "$env:systemdrive": "C:",
        "$env:systemroot": "C:\\WINDOWS",
        "$env:temp": "C:\\Users\\victim\\AppData\\Local\\Temp",
        "$env:tmp": "C:\\Users\\victim\\AppData\\Local\\Temp",
        "$env:userdomain": "fakedomain",
        "$env:username": "victim",
        "$env:userprofile": "C:\\Users\\victim",
        "$env:windir": "C:\\WINDOWS",
        "$bshome": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0",
        "$bshome1": "C:\\Windows\\System32\\WindowsPowerShell\\v1.0",
        "$MaximumDriveCount": 4096
    },
    "behaviorProps": {
        "code_import": ["code"],
        "file_system": ["paths"],
        "script_exec": ["script"],
        "process": ["processes"],
        "new_object": ["object"],
        "download": ["uri"],
        "upload": ["uri", "data"],
        "file_exec": ["files"]
    },
    "commandlets": {
        "file_system": {
            "Get-Item": {
                "FullActor": "Microsoft.PowerShell.Management\\Get-Item",
                "BehaviorPropArgs": {
                    "paths": ["Path", "LiteralPath"]
                },
                "Flags": ["call_parent"]
            },
            "Set-Content": {
                "FullActor": "Microsoft.PowerShell.Management\\Set-Content",
                "BehaviorPropArgs": {
                    "paths": ["Path", "LiteralPath"]
                }
            },
            "Set-Location": {
                "FullActor": "Microsoft.PowerShell.Management\\Set-Location",
                "BehaviorPropArgs": {
                    "paths": ["Path", "LiteralPath"]
                }
            },
            "New-Item": {
                "FullActor": "Microsoft.PowerShell.Management\\New-Item",
                "BehaviorPropArgs": {
                    "paths": ["Path", "Name"]
                }
            },
            "Get-ChildItem": {
                "FullActor": "Microsoft.PowerShell.Management\\Get-ChildItem",
                "BehaviorPropArgs": {
                    "paths": ["Path"]
                }
            },
            "Test-Path": {
                "FullActor": "Microsoft.PowerShell.Management\\Test-Path",
                "BehaviorPropArgs": {
                    "paths": ["Path"]
                }
            },
            "Get-Content": {
                "FullActor": "Microsoft.PowerShell.Management\\Get-Content",
                "BehaviorPropArgs": {
                    "paths": ["Path", "LiteralPath"]
                }
            },
            "Remove-Item": {
                "FullActor": "Microsoft.PowerShell.Management\\Remove-Item",
                "BehaviorPropArgs": {
                    "paths": ["Path", "LiteralPath"]
                }
            }
        },
        "process": {
            "Get-Process": {
                "FullActor": "Microsoft.PowerShell.Management\\Get-Process",
                "BehaviorPropArgs": {
                    "processes": ["Name", "Id", "InputObject"]
                },
                "ArgModifications": {
                    "InputObject": ["FlattenProcessObjects <arg>"]
                }
            },
            "Stop-Process": {
                "FullActor": "Microsoft.PowerShell.Management\\Stop-Process",
                "BehaviorPropArgs": {
                    "processes": ["Name", "Id", "InputObject"]
                },
                "ArgModifications": {
                    "InputObject": ["FlattenProcessObjects <arg>"]
                }
            },
            "Start-Sleep": {
                "FullActor": "Microsoft.PowerShell.Utility\\Start-Sleep",
                "BehaviorPropArgs": {
                    "processes": "self"
                }
            }
        },
        "code_import": {
            "Add-Type": {
                "FullActor": "Microsoft.PowerShell.Utility\\Add-Type",
                "BehaviorPropArgs": {
                    "code": ["TypeDefinition"]
                }
            }
        },
        "script_exec": {
            "Invoke-Expression": {
                "FullActor": "Microsoft.PowerShell.Utility\\Invoke-Expression",
                "BehaviorPropArgs": {
                    "script": ["Command"]
                },
                "LayerArg": "Command"
            }
        },
        "file_exec": {
            "Start-Process": {
                "FullActor": "Microsoft.PowerShell.Management\\Start-Process",
                "BehaviorPropArgs": {
                    "files": ["FilePath"]
                }
            },
            "Invoke-Item": {
                "FullActor": "Microsoft.PowerShell.Management\\Invoke-Item",
                "BehaviorPropArgs": {
                    "files": ["Path", "LiteralPath"]
                }
            }
        },
        "new_object": {
            "New-Object": {
                "FullActor": "Microsoft.PowerShell.Utility\\New-Object",
                "BehaviorPropArgs": {
                    "object": ["COMObject", "TypeName"]
                },
                "ArgAdditions": {
                    "COMObject": {
                        "pipelineInput": "false",
                        "type": {
                            "name": "string"
                        },
                        "aliases": "None",
                        "name": "COMObject",
                        "position": "Named",
                        "parameterSetName": "(All)",
                        "required": "false"
                    }
                },
                "ArgModifications": {
                    "TypeName": "<arg>.ToLower()",
                    "COMObject": "<arg>.ToLower()"
                },
                "ExtraCode": [
                    "if ($(GetOverridedClasses).Contains($TypeName.ToLower())) {",
                    "   return RedirectObjectCreation $TypeName",
                    "}"
                ],
                "Flags": ["call_parent"]
            }
        },
        "other": {
            "Set-ExecutionPolicy": {
                "FullActor": "Microsoft.PowerShell.Security\\Set-ExecutionPolicy"
            }
        }
    },
    "classes": {
        "System.Net.WebClient": {
            "download": {
                "DownloadFile": {
                    "uri": ["address"]
                },
                "DownloadString": {
                    "uri": ["address"]
                },
                "DownloadData": {
                    "uri": ["address"]
                }
            },
            "upload": {
                "UploadString": {
                    "uri": ["address"],
                    "data": ["data"]
                }
            }
        }
    }
}